<!DOCTYPE html>
<html>
<head>
    <title>Console Log Collector</title>
    <style>
        body { font-family: 'Courier New', monospace; margin: 20px; background: #1e1e1e; color: #fff; }
        .log { margin: 5px 0; padding: 5px; border-left: 3px solid #555; }
        .log.info { border-color: #0078d4; }
        .log.warn { border-color: #ff6b35; }
        .log.error { border-color: #f85149; }
        .log.success { border-color: #28a745; }
        #frame { width: 100%; height: 400px; border: 1px solid #555; margin: 20px 0; }
    </style>
</head>
<body>
    <h1>üîç VB6 Web IDE - Console Monitor</h1>
    <div id="logs"></div>
    
    <iframe id="frame" src="/"></iframe>
    
    <script>
        const logs = document.getElementById('logs');
        const frame = document.getElementById('frame');
        
        function addLog(message, level = 'info') {
            const div = document.createElement('div');
            div.className = `log ${level}`;
            div.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong> [${level.toUpperCase()}] ${message}`;
            logs.appendChild(div);
            logs.scrollTop = logs.scrollHeight;
        }
        
        addLog('üîç Starting console monitor...', 'info');
        
        // Monitor frame loading
        frame.onload = () => {
            addLog('‚úÖ Frame loaded successfully', 'success');
            
            try {
                // Try to access frame console (may be blocked by CORS)
                const frameWindow = frame.contentWindow;
                if (frameWindow) {
                    addLog('‚úÖ Frame window accessible', 'success');
                    
                    // Override console methods in frame
                    const originalLog = frameWindow.console.log;
                    const originalError = frameWindow.console.error;
                    const originalWarn = frameWindow.console.warn;
                    
                    frameWindow.console.log = function(...args) {
                        addLog(args.join(' '), 'info');
                        return originalLog.apply(this, args);
                    };
                    
                    frameWindow.console.error = function(...args) {
                        addLog(args.join(' '), 'error');
                        return originalError.apply(this, args);
                    };
                    
                    frameWindow.console.warn = function(...args) {
                        addLog(args.join(' '), 'warn');
                        return originalWarn.apply(this, args);
                    };
                    
                    // Listen for errors
                    frameWindow.addEventListener('error', (e) => {
                        addLog(`‚ùå Error: ${e.message} at ${e.filename}:${e.lineno}`, 'error');
                    });
                    
                    frameWindow.addEventListener('unhandledrejection', (e) => {
                        addLog(`‚ùå Unhandled Promise: ${e.reason}`, 'error');
                    });
                    
                } else {
                    addLog('‚ùå Frame window not accessible (CORS?)', 'warn');
                }
            } catch (e) {
                addLog(`‚ùå Failed to monitor frame: ${e.message}`, 'error');
            }
        };
        
        frame.onerror = () => {
            addLog('‚ùå Frame failed to load', 'error');
        };
        
        // Global error handling
        window.addEventListener('error', (e) => {
            addLog(`‚ùå Global Error: ${e.message}`, 'error');
        });
        
        window.addEventListener('unhandledrejection', (e) => {
            addLog(`‚ùå Global Promise Rejection: ${e.reason}`, 'error');
        });
        
        addLog('üîç Monitor ready, loading main app...', 'info');
    </script>
</body>
</html>