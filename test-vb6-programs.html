<!doctype html>
<html>
  <head>
    <title>Test des Programmes VB6</title>
    <style>
      body {
        font-family: Arial;
        margin: 20px;
        background: #f5f5f5;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
      }
      .program-card {
        background: white;
        margin: 20px 0;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .program-title {
        color: #2c3e50;
        border-bottom: 2px solid #3498db;
        padding-bottom: 10px;
        margin-bottom: 15px;
      }
      .program-description {
        color: #666;
        margin-bottom: 15px;
        line-height: 1.6;
      }
      .features {
        background: #f8f9fa;
        padding: 10px;
        border-radius: 4px;
        margin: 10px 0;
      }
      .load-button {
        background: #3498db;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
        margin-right: 10px;
      }
      .load-button:hover {
        background: #2980b9;
      }
      .status {
        margin-top: 10px;
        padding: 8px;
        border-radius: 4px;
        font-weight: bold;
      }
      .success {
        background: #d4edda;
        color: #155724;
      }
      .error {
        background: #f8d7da;
        color: #721c24;
      }
      .info {
        background: #d1ecf1;
        color: #0c5460;
      }
      .code-preview {
        background: #2c3e50;
        color: #ecf0f1;
        padding: 15px;
        border-radius: 4px;
        font-family: 'Courier New', monospace;
        font-size: 12px;
        overflow: auto;
        max-height: 200px;
        margin: 10px 0;
      }
      .stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 10px;
        margin: 20px 0;
      }
      .stat-card {
        background: white;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .stat-number {
        font-size: 24px;
        font-weight: bold;
        color: #3498db;
      }
      .stat-label {
        color: #666;
        margin-top: 5px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üß™ Test des Programmes VB6 - VB6 Web IDE</h1>

      <div class="stats">
        <div class="stat-card">
          <div class="stat-number" id="totalPrograms">5</div>
          <div class="stat-label">Programmes de Test</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="loadedPrograms">0</div>
          <div class="stat-label">Programmes Charg√©s</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="totalControls">0</div>
          <div class="stat-label">Contr√¥les Total</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="totalLines">0</div>
          <div class="stat-label">Lignes de Code</div>
        </div>
      </div>

      <!-- HelloWorld Program -->
      <div class="program-card">
        <h2 class="program-title">1. HelloWorld.frm - Programme de Base</h2>
        <div class="program-description">
          Programme simple qui d√©montre les fonctionnalit√©s de base : InputBox, MsgBox, gestion
          d'√©v√©nements et manipulation de propri√©t√©s.
        </div>
        <div class="features">
          <strong>Fonctionnalit√©s test√©es :</strong> Form_Load, CommandButton_Click, Label.Caption,
          InputBox, MsgBox, String concatenation
        </div>
        <button class="load-button" onclick="loadProgram('HelloWorld')">
          üì± Charger HelloWorld
        </button>
        <button class="load-button" onclick="showCode('HelloWorld')">üìÑ Voir le Code</button>
        <div id="HelloWorld-status" class="status info" style="display: none">
          Pr√™t √† charger...
        </div>
        <div id="HelloWorld-code" class="code-preview" style="display: none"></div>
      </div>

      <!-- Calculator Program -->
      <div class="program-card">
        <h2 class="program-title">2. CalculatorTest.frm - Calculatrice Avanc√©e</h2>
        <div class="program-description">
          Calculatrice compl√®te avec arrays de contr√¥les, gestion d'erreurs et historique. Teste les
          calculs math√©matiques et la gestion des √©v√©nements complexes.
        </div>
        <div class="features">
          <strong>Fonctionnalit√©s test√©es :</strong> Control Arrays, Select Case, Mathematical
          operations, Error handling, String formatting
        </div>
        <button class="load-button" onclick="loadProgram('CalculatorTest')">
          üßÆ Charger Calculatrice
        </button>
        <button class="load-button" onclick="showCode('CalculatorTest')">üìÑ Voir le Code</button>
        <div id="CalculatorTest-status" class="status info" style="display: none">
          Pr√™t √† charger...
        </div>
        <div id="CalculatorTest-code" class="code-preview" style="display: none"></div>
      </div>

      <!-- Database Program -->
      <div class="program-card">
        <h2 class="program-title">3. DatabaseTest.frm - Gestion de Base de Donn√©es</h2>
        <div class="program-description">
          Application de gestion de clients avec DataGrid, DataList et op√©rations CRUD. Teste les
          contr√¥les de donn√©es et les types personnalis√©s.
        </div>
        <div class="features">
          <strong>Fonctionnalit√©s test√©es :</strong> User-defined Types, DataGrid, DataList, File
          I/O, Search functionality, Export operations
        </div>
        <button class="load-button" onclick="loadProgram('DatabaseTest')">
          üóÉÔ∏è Charger Base de Donn√©es
        </button>
        <button class="load-button" onclick="showCode('DatabaseTest')">üìÑ Voir le Code</button>
        <div id="DatabaseTest-status" class="status info" style="display: none">
          Pr√™t √† charger...
        </div>
        <div id="DatabaseTest-code" class="code-preview" style="display: none"></div>
      </div>

      <!-- Graphics Program -->
      <div class="program-card">
        <h2 class="program-title">4. GraphicsTest.frm - Graphiques et Animation</h2>
        <div class="program-description">
          D√©monstrateur de fonctions graphiques avec PictureBox, dessins g√©om√©triques, couleurs et
          animations. Teste le syst√®me graphique complet.
        </div>
        <div class="features">
          <strong>Fonctionnalit√©s test√©es :</strong> PictureBox, Graphics methods (Circle, Line,
          PSet), Color manipulation, Timer, Animation
        </div>
        <button class="load-button" onclick="loadProgram('GraphicsTest')">
          üé® Charger Graphiques
        </button>
        <button class="load-button" onclick="showCode('GraphicsTest')">üìÑ Voir le Code</button>
        <div id="GraphicsTest-status" class="status info" style="display: none">
          Pr√™t √† charger...
        </div>
        <div id="GraphicsTest-code" class="code-preview" style="display: none"></div>
      </div>

      <!-- Game Program -->
      <div class="program-card">
        <h2 class="program-title">5. GameTest.frm - Jeu Snake</h2>
        <div class="program-description">
          Jeu Snake complet avec gestion du clavier, collision detection, score et niveaux. Teste
          les fonctionnalit√©s de jeu et la performance.
        </div>
        <div class="features">
          <strong>Fonctionnalit√©s test√©es :</strong> KeyPreview, Form_KeyDown, Timer, Constants,
          Types, Game logic, Performance optimization
        </div>
        <button class="load-button" onclick="loadProgram('GameTest')">üêç Charger Snake Game</button>
        <button class="load-button" onclick="showCode('GameTest')">üìÑ Voir le Code</button>
        <div id="GameTest-status" class="status info" style="display: none">Pr√™t √† charger...</div>
        <div id="GameTest-code" class="code-preview" style="display: none"></div>
      </div>

      <div class="program-card">
        <h2 class="program-title">üìä R√©sultats des Tests</h2>
        <div id="test-results">
          <p>Cliquez sur les boutons "Charger" pour tester chaque programme dans le VB6 Web IDE.</p>
        </div>
      </div>
    </div>

    <script>
      let loadedPrograms = 0;
      let totalControls = 0;
      let totalLines = 0;

      const programData = {
        HelloWorld: {
          controls: 3,
          lines: 45,
          code: `Private Sub Form_Load()
    Me.Caption = "Hello World - Test VB6 Web IDE"
    lblMessage.Caption = "Bienvenue dans VB6 Web IDE!"
End Sub

Private Sub cmdHello_Click()
    Dim userName As String
    userName = InputBox("Quel est votre nom ?", "Bonjour", "Utilisateur")
    If userName <> "" Then
        lblMessage.Caption = "Bonjour " & userName & "!"
        MsgBox "Hello " & userName & "!", vbInformation
    End If
End Sub`,
        },
        CalculatorTest: {
          controls: 20,
          lines: 185,
          code: `Private Sub cmdNumber_Click(Index As Integer)
    If Index = 10 Then  ' Point d√©cimal
        numberStr = "."
    Else  ' Chiffres 0-9
        numberStr = CStr(Index)
    End If
    currentValue = Val(lblDisplay.Caption)
End Sub

Private Sub PerformCalculation()
    Select Case currentOperation
        Case "+"
            result = previousValue + currentValue
        Case "-"
            result = previousValue - currentValue
        Case "*"
            result = previousValue * currentValue
        Case "/"
            If currentValue = 0 Then
                MsgBox "Erreur: Division par z√©ro!", vbCritical
                Exit Sub
            End If
            result = previousValue / currentValue
    End Select
End Sub`,
        },
        DatabaseTest: {
          controls: 15,
          lines: 320,
          code: `Private Type Customer
    ID As Long
    FirstName As String
    LastName As String
    City As String
    Phone As String
    Email As String
End Type

Private customers() As Customer

Private Sub LoadCustomerData()
    For i = 1 To customerCount
        dataString = dataString & customers(i).ID & vbTab & _
                     customers(i).FirstName & vbTab & _
                     customers(i).LastName
    Next i
End Sub`,
        },
        GraphicsTest: {
          controls: 12,
          lines: 480,
          code: `Private Sub DrawCircles()
    For i = 1 To 15
        radius = i * 10
        color = RGB((i * 17) Mod 256, (i * 23) Mod 256, (i * 31) Mod 256)
        picCanvas.Circle (picCanvas.ScaleWidth / 2, picCanvas.ScaleHeight / 2), radius, color
    Next i
End Sub

Private Sub tmrAnimation_Timer()
    animationStep = animationStep + animationDirection * 5
    ballX = 100 + animationStep
    ballY = 300 + 100 * Sin(animationStep * 0.02)
    picCanvas.Circle (ballX, ballY), 20, RGB(255, 0, 0)
End Sub`,
        },
        GameTest: {
          controls: 8,
          lines: 425,
          code: `Const GRID_SIZE = 15
Const MAX_SNAKE_LENGTH = 500

Private Type Point
    x As Integer
    y As Integer
End Type

Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
    Select Case KeyCode
        Case vbKeyUp
            If snake.direction <> DIR_DOWN Then snake.direction = DIR_UP
        Case vbKeyDown
            If snake.direction <> DIR_UP Then snake.direction = DIR_DOWN
        Case vbKeyLeft
            If snake.direction <> DIR_RIGHT Then snake.direction = DIR_LEFT
        Case vbKeyRight
            If snake.direction <> DIR_LEFT Then snake.direction = DIR_RIGHT
    End Select
End Sub`,
        },
      };

      function loadProgram(programName) {
        const statusDiv = document.getElementById(programName + '-status');
        statusDiv.style.display = 'block';
        statusDiv.className = 'status info';
        statusDiv.textContent = 'Chargement en cours...';

        // Simuler le chargement du programme
        setTimeout(() => {
          try {
            // Simuler le processus de chargement
            const program = programData[programName];

            // Mise √† jour des statistiques
            loadedPrograms++;
            totalControls += program.controls;
            totalLines += program.lines;

            updateStats();

            // Test de l'ouverture dans une nouvelle fen√™tre
            const vb6Url = 'http://localhost:8081/?program=' + programName;
            const newWindow = window.open(vb6Url, '_blank', 'width=1200,height=800');

            if (newWindow) {
              statusDiv.className = 'status success';
              statusDiv.innerHTML = `‚úÖ Programme charg√© avec succ√®s!<br>
                                             üìä ${program.controls} contr√¥les, ${program.lines} lignes de code<br>
                                             üåê Ouvert dans une nouvelle fen√™tre`;

              // V√©rifier si la fen√™tre se charge correctement
              setTimeout(() => {
                if (newWindow.closed) {
                  statusDiv.className = 'status error';
                  statusDiv.textContent = '‚ùå La fen√™tre a √©t√© ferm√©e';
                }
              }, 2000);
            } else {
              statusDiv.className = 'status error';
              statusDiv.textContent = "‚ùå Impossible d'ouvrir une nouvelle fen√™tre (popup bloqu√©?)";
            }
          } catch (error) {
            statusDiv.className = 'status error';
            statusDiv.textContent = '‚ùå Erreur lors du chargement: ' + error.message;
          }
        }, 1000);
      }

      function showCode(programName) {
        const codeDiv = document.getElementById(programName + '-code');
        const program = programData[programName];

        if (codeDiv.style.display === 'none') {
          codeDiv.style.display = 'block';
          codeDiv.textContent = program.code;
        } else {
          codeDiv.style.display = 'none';
        }
      }

      function updateStats() {
        document.getElementById('loadedPrograms').textContent = loadedPrograms;
        document.getElementById('totalControls').textContent = totalControls;
        document.getElementById('totalLines').textContent = totalLines;
      }

      // V√©rifier si le serveur VB6 IDE est accessible
      fetch('http://localhost:8081/')
        .then(response => {
          if (response.ok) {
            document.getElementById('test-results').innerHTML = `
                        <div class="status success">
                            ‚úÖ VB6 Web IDE accessible sur http://localhost:8081/<br>
                            Vous pouvez maintenant tester les programmes VB6!
                        </div>
                    `;
          } else {
            throw new Error('Server not responding correctly');
          }
        })
        .catch(error => {
          document.getElementById('test-results').innerHTML = `
                    <div class="status error">
                        ‚ùå VB6 Web IDE non accessible sur http://localhost:8081/<br>
                        Erreur: ${error.message}<br>
                        Assurez-vous que le serveur de d√©veloppement est d√©marr√© avec "npm run dev"
                    </div>
                `;
        });
    </script>
  </body>
</html>
