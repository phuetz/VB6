<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>√âvaluation Ultra-D√©taill√©e du Runtime VB6</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }
      .container {
        max-width: 1400px;
        margin: 0 auto;
        background: white;
        border-radius: 12px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        padding: 30px;
      }
      .header {
        text-align: center;
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        color: white;
        padding: 30px;
        border-radius: 12px;
        margin-bottom: 30px;
      }
      .header h1 {
        font-size: 2.5em;
        margin-bottom: 10px;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }
      .header p {
        font-size: 1.2em;
        opacity: 0.9;
      }
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }
      .stat-card {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
        padding: 25px;
        border-radius: 12px;
        text-align: center;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        transition:
          transform 0.3s ease,
          box-shadow 0.3s ease;
      }
      .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
      }
      .stat-number {
        font-size: 3em;
        font-weight: bold;
        margin-bottom: 10px;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }
      .stat-label {
        font-size: 1.1em;
        opacity: 0.9;
      }
      .test-section {
        background: #f8f9fa;
        border-radius: 12px;
        padding: 25px;
        margin: 20px 0;
        border-left: 5px solid #4facfe;
      }
      .test-section h2 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 1.8em;
      }
      .test-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
      }
      .test-item {
        background: white;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
      }
      .test-item:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      }
      .test-item h3 {
        color: #e74c3c;
        margin-bottom: 10px;
        font-size: 1.3em;
      }
      .test-button {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1em;
        font-weight: bold;
        margin: 5px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
      }
      .test-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(79, 172, 254, 0.4);
      }
      .result-area {
        background: #2c3e50;
        color: #ecf0f1;
        padding: 15px;
        border-radius: 8px;
        margin: 10px 0;
        font-family: 'Courier New', monospace;
        font-size: 14px;
        min-height: 120px;
        overflow-y: auto;
        max-height: 300px;
      }
      .progress-bar {
        background: #ddd;
        border-radius: 10px;
        padding: 3px;
        margin: 10px 0;
      }
      .progress-fill {
        background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
        height: 20px;
        border-radius: 10px;
        transition: width 0.5s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      }
      .status-success {
        color: #27ae60;
        font-weight: bold;
      }
      .status-error {
        color: #e74c3c;
        font-weight: bold;
      }
      .status-warning {
        color: #f39c12;
        font-weight: bold;
      }
      .performance-chart {
        background: white;
        border-radius: 8px;
        padding: 20px;
        margin: 10px 0;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üß™ √âvaluation Ultra-D√©taill√©e du Runtime VB6</h1>
        <p>Analyse compl√®te de l'int√©gration et performance du runtime VB6 Web IDE</p>
      </div>

      <!-- Statistiques g√©n√©rales -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-number" id="totalFunctions">0</div>
          <div class="stat-label">Fonctions VB6 Disponibles</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="testedFunctions">0</div>
          <div class="stat-label">Fonctions Test√©es</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="successRate">0%</div>
          <div class="stat-label">Taux de Succ√®s</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="performanceScore">0</div>
          <div class="stat-label">Score Performance</div>
        </div>
      </div>

      <!-- Barre de progression globale -->
      <div class="progress-bar">
        <div class="progress-fill" id="globalProgress" style="width: 0%">0%</div>
      </div>

      <!-- Tests des fonctions String -->
      <div class="test-section">
        <h2>üî§ Tests des Fonctions String VB6</h2>
        <div class="test-grid">
          <div class="test-item">
            <h3>Fonctions de Base</h3>
            <p>Left, Right, Mid, Len, InStr, Replace, Trim</p>
            <button class="test-button" onclick="testStringBasics()">
              üß™ Tester Fonctions de Base
            </button>
            <div class="result-area" id="stringBasicsResult"></div>
          </div>
          <div class="test-item">
            <h3>Fonctions Avanc√©es</h3>
            <p>StrComp, StrConv, StrReverse, Filter, Split, Join</p>
            <button class="test-button" onclick="testStringAdvanced()">
              üî¨ Tester Fonctions Avanc√©es
            </button>
            <div class="result-area" id="stringAdvancedResult"></div>
          </div>
        </div>
      </div>

      <!-- Tests des fonctions Math -->
      <div class="test-section">
        <h2>üßÆ Tests des Fonctions Math√©matiques</h2>
        <div class="test-grid">
          <div class="test-item">
            <h3>Fonctions Trigonom√©triques</h3>
            <p>Sin, Cos, Tan, Atn, Asin, Acos</p>
            <button class="test-button" onclick="testMathTrig()">üìê Tester Trigonom√©trie</button>
            <div class="result-area" id="mathTrigResult"></div>
          </div>
          <div class="test-item">
            <h3>Fonctions Arithm√©tiques</h3>
            <p>Abs, Int, Fix, Sqr, Log, Exp, Rnd</p>
            <button class="test-button" onclick="testMathArithmetic()">
              üî¢ Tester Arithm√©tique
            </button>
            <div class="result-area" id="mathArithmeticResult"></div>
          </div>
        </div>
      </div>

      <!-- Tests des fonctions de Conversion -->
      <div class="test-section">
        <h2>üîÑ Tests des Fonctions de Conversion</h2>
        <div class="test-grid">
          <div class="test-item">
            <h3>Conversions de Type</h3>
            <p>CInt, CLng, CStr, CDate, CDbl, CBool</p>
            <button class="test-button" onclick="testConversions()">üéØ Tester Conversions</button>
            <div class="result-area" id="conversionsResult"></div>
          </div>
          <div class="test-item">
            <h3>Fonctions de Validation</h3>
            <p>IsNumeric, IsDate, VarType, TypeName</p>
            <button class="test-button" onclick="testValidation()">‚úÖ Tester Validation</button>
            <div class="result-area" id="validationResult"></div>
          </div>
        </div>
      </div>

      <!-- Tests des fonctions Date/Time -->
      <div class="test-section">
        <h2>üìÖ Tests des Fonctions Date/Heure</h2>
        <div class="test-grid">
          <div class="test-item">
            <h3>Manipulation de Dates</h3>
            <p>DateAdd, DateDiff, DatePart, Format</p>
            <button class="test-button" onclick="testDateTime()">üóìÔ∏è Tester Dates</button>
            <div class="result-area" id="dateTimeResult"></div>
          </div>
          <div class="test-item">
            <h3>Fonctions Temporelles</h3>
            <p>Timer, Now, Date, Time, Year, Month, Day</p>
            <button class="test-button" onclick="testTimeFunc()">‚è∞ Tester Temps</button>
            <div class="result-area" id="timeFuncResult"></div>
          </div>
        </div>
      </div>

      <!-- Tests de Performance -->
      <div class="test-section">
        <h2>‚ö° Tests de Performance Runtime</h2>
        <div class="test-grid">
          <div class="test-item">
            <h3>Benchmarks Intensifs</h3>
            <p>Tests de vitesse sur 10,000 op√©rations</p>
            <button class="test-button" onclick="testPerformance()">üöÄ Benchmark Runtime</button>
            <div class="result-area" id="performanceResult"></div>
          </div>
          <div class="test-item">
            <h3>Test de M√©moire</h3>
            <p>Gestion m√©moire et garbage collection</p>
            <button class="test-button" onclick="testMemory()">üíæ Tester M√©moire</button>
            <div class="result-area" id="memoryResult"></div>
          </div>
        </div>
      </div>

      <!-- Test d'ex√©cution de programme VB6 complet -->
      <div class="test-section">
        <h2>üèÉ Test d'Ex√©cution Compl√®te VB6</h2>
        <div class="test-item">
          <h3>Programme VB6 Complet</h3>
          <p>Ex√©cution d'un programme VB6 complet avec formulaire, √©v√©nements et logique m√©tier</p>
          <button class="test-button" onclick="testCompleteVB6Program()">
            üé¨ Ex√©cuter Programme Complet
          </button>
          <div class="result-area" id="completeResult"></div>
        </div>
      </div>

      <!-- R√©sultats finaux -->
      <div class="test-section">
        <h2>üìä Rapport Final d'√âvaluation</h2>
        <div class="performance-chart" id="finalReport">
          <p>Cliquez sur "G√©n√©rer Rapport Final" apr√®s avoir effectu√© tous les tests.</p>
          <button class="test-button" onclick="generateFinalReport()">
            üìã G√©n√©rer Rapport Final
          </button>
        </div>
      </div>
    </div>

    <script>
              // Variables globales pour les statistiques
              let testResults = {
                  totalTests: 0,
                  passedTests: 0,
                  failedTests: 0,
                  performanceScores: [],
                  functionResults: new Map(),
                  startTime: Date.now()
              };

              // Fonction utilitaire pour logger les r√©sultats
              function logResult(elementId, message, isSuccess = true) {
                  const element = document.getElementById(elementId);
                  const timestamp = new Date().toLocaleTimeString();
                  const status = isSuccess ? '‚úÖ' : '‚ùå';
                  const className = isSuccess ? 'status-success' : 'status-error';

                  element.innerHTML += `<div class="${className}">[${timestamp}] ${status} ${message}</div>`;
                  element.scrollTop = element.scrollHeight;
              }

              // Test des fonctions String de base
              function testStringBasics() {
                  const resultDiv = 'stringBasicsResult';
                  document.getElementById(resultDiv).innerHTML = '';
                  logResult(resultDiv, 'D√©but des tests String de base...', true);

                  let passed = 0, total = 0;

                  // Test Left
                  total++;
                  try {
                      if (typeof Left === 'function') {
                          const result = Left('Hello World', 5);
                          if (result === 'Hello') {
                              logResult(resultDiv, `Left('Hello World', 5) = '${result}' ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Left('Hello World', 5) = '${result}' (attendu: 'Hello') ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Left non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Left: ${e.message} ‚úó`, false);
                  }

                  // Test Right
                  total++;
                  try {
                      if (typeof Right === 'function') {
                          const result = Right('Hello World', 5);
                          if (result === 'World') {
                              logResult(resultDiv, `Right('Hello World', 5) = '${result}' ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Right('Hello World', 5) = '${result}' (attendu: 'World') ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Right non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Right: ${e.message} ‚úó`, false);
                  }

                  // Test Mid
                  total++;
                  try {
                      if (typeof Mid === 'function') {
                          const result = Mid('Hello World', 7, 5);
                          if (result === 'World') {
                              logResult(resultDiv, `Mid('Hello World', 7, 5) = '${result}' ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Mid('Hello World', 7, 5) = '${result}' (attendu: 'World') ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Mid non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Mid: ${e.message} ‚úó`, false);
                  }

                  // Test Len
                  total++;
                  try {
                      if (typeof Len === 'function') {
                          const result = Len('Hello World');
                          if (result === 11) {
                              logResult(resultDiv, `Len('Hello World') = ${result} ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Len('Hello World') = ${result} (attendu: 11) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Len non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Len: ${e.message} ‚úó`, false);
                  }

                  // Test InStr
                  total++;
                  try {
                      if (typeof InStr === 'function') {
                          const result = InStr('Hello World', 'World');
                          if (result === 7) {
                              logResult(resultDiv, `InStr('Hello World', 'World') = ${result} ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `InStr('Hello World', 'World') = ${result} (attendu: 7) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction InStr non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur InStr: ${e.message} ‚úó`, false);
                  }

                  // Test Replace
                  total++;
                  try {
                      if (typeof Replace === 'function') {
                          const result = Replace('Hello World', 'World', 'VB6');
                          if (result === 'Hello VB6') {
                              logResult(resultDiv, `Replace('Hello World', 'World', 'VB6') = '${result}' ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Replace('Hello World', 'World', 'VB6') = '${result}' (attendu: 'Hello VB6') ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Replace non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Replace: ${e.message} ‚úó`, false);
                  }

                  // Test Trim
                  total++;
                  try {
                      if (typeof Trim === 'function') {
                          const result = Trim('  Hello World  ');
                          if (result === 'Hello World') {
                              logResult(resultDiv, `Trim('  Hello World  ') = '${result}' ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Trim('  Hello World  ') = '${result}' (attendu: 'Hello World') ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Trim non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Trim: ${e.message} ‚úó`, false);
                  }

                  const successRate = Math.round((passed / total) * 100);
                  logResult(resultDiv, `\n=== R√©sultat: ${passed}/${total} tests r√©ussis (${successRate}%) ===`, passed === total);

                  testResults.totalTests += total;
                  testResults.passedTests += passed;
                  testResults.failedTests += (total - passed);
                  testResults.functionResults.set('StringBasics', { passed, total, successRate });

                  updateGlobalStats();
              }

              // Test des fonctions String avanc√©es
              function testStringAdvanced() {
                  const resultDiv = 'stringAdvancedResult';
                  document.getElementById(resultDiv).innerHTML = '';
                  logResult(resultDiv, 'D√©but des tests String avanc√©s...', true);

                  let passed = 0, total = 0;

                  // Test StrComp
                  total++;
                  try {
                      if (typeof StrComp === 'function') {
                          const result = StrComp('Hello', 'hello', 1); // Comparaison insensible √† la casse
                          if (result === 0) {
                              logResult(resultDiv, `StrComp('Hello', 'hello', 1) = ${result} ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `StrComp('Hello', 'hello', 1) = ${result} (attendu: 0) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction StrComp non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur StrComp: ${e.message} ‚úó`, false);
                  }

                  // Test StrReverse
                  total++;
                  try {
                      if (typeof StrReverse === 'function') {
                          const result = StrReverse('Hello');
                          if (result === 'olleH') {
                              logResult(resultDiv, `StrReverse('Hello') = '${result}' ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `StrReverse('Hello') = '${result}' (attendu: 'olleH') ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction StrReverse non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur StrReverse: ${e.message} ‚úó`, false);
                  }

                  // Test Split
                  total++;
                  try {
                      if (typeof Split === 'function') {
                          const result = Split('A,B,C,D', ',');
                          if (Array.isArray(result) && result.length === 4 && result[0] === 'A' && result[3] === 'D') {
                              logResult(resultDiv, `Split('A,B,C,D', ',') = [${result.join(', ')}] ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Split('A,B,C,D', ',') = [${result ? result.join(', ') : 'undefined'}] ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Split non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Split: ${e.message} ‚úó`, false);
                  }

                  // Test Join
                  total++;
                  try {
                      if (typeof Join === 'function') {
                          const result = Join(['A', 'B', 'C', 'D'], '-');
                          if (result === 'A-B-C-D') {
                              logResult(resultDiv, `Join(['A', 'B', 'C', 'D'], '-') = '${result}' ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Join(['A', 'B', 'C', 'D'], '-') = '${result}' (attendu: 'A-B-C-D') ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Join non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Join: ${e.message} ‚úó`, false);
                  }

                  // Test Filter
                  total++;
                  try {
                      if (typeof Filter === 'function') {
                          const result = Filter(['Apple', 'Banana', 'Apricot', 'Cherry'], 'A');
                          if (Array.isArray(result) && result.length === 2) {
                              logResult(resultDiv, `Filter(['Apple', 'Banana', 'Apricot', 'Cherry'], 'A') = [${result.join(', ')}] ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Filter(['Apple', 'Banana', 'Apricot', 'Cherry'], 'A') = [${result ? result.join(', ') : 'undefined'}] ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Filter non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Filter: ${e.message} ‚úó`, false);
                  }

                  const successRate = Math.round((passed / total) * 100);
                  logResult(resultDiv, `\n=== R√©sultat: ${passed}/${total} tests r√©ussis (${successRate}%) ===`, passed === total);

                  testResults.totalTests += total;
                  testResults.passedTests += passed;
                  testResults.failedTests += (total - passed);
                  testResults.functionResults.set('StringAdvanced', { passed, total, successRate });

                  updateGlobalStats();
              }

              // Test des fonctions Math trigonom√©triques
              function testMathTrig() {
                  const resultDiv = 'mathTrigResult';
                  document.getElementById(resultDiv).innerHTML = '';
                  logResult(resultDiv, 'D√©but des tests Math trigonom√©triques...', true);

                  let passed = 0, total = 0;

                  // Test Sin
                  total++;
                  try {
                      if (typeof Sin === 'function') {
                          const result = Sin(Math.PI / 2);
                          if (Math.abs(result - 1) < 0.0001) {
                              logResult(resultDiv, `Sin(œÄ/2) = ${result.toFixed(4)} ‚âà 1.0000 ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Sin(œÄ/2) = ${result.toFixed(4)} (attendu: ‚âà 1.0000) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Sin non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Sin: ${e.message} ‚úó`, false);
                  }

                  // Test Cos
                  total++;
                  try {
                      if (typeof Cos === 'function') {
                          const result = Cos(0);
                          if (Math.abs(result - 1) < 0.0001) {
                              logResult(resultDiv, `Cos(0) = ${result.toFixed(4)} ‚âà 1.0000 ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Cos(0) = ${result.toFixed(4)} (attendu: ‚âà 1.0000) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Cos non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Cos: ${e.message} ‚úó`, false);
                  }

                  // Test Tan
                  total++;
                  try {
                      if (typeof Tan === 'function') {
                          const result = Tan(Math.PI / 4);
                          if (Math.abs(result - 1) < 0.0001) {
                              logResult(resultDiv, `Tan(œÄ/4) = ${result.toFixed(4)} ‚âà 1.0000 ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Tan(œÄ/4) = ${result.toFixed(4)} (attendu: ‚âà 1.0000) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Tan non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Tan: ${e.message} ‚úó`, false);
                  }

                  // Test Atn (arctangent)
                  total++;
                  try {
                      if (typeof Atn === 'function') {
                          const result = Atn(1);
                          if (Math.abs(result - Math.PI / 4) < 0.0001) {
                              logResult(resultDiv, `Atn(1) = ${result.toFixed(4)} ‚âà ${(Math.PI / 4).toFixed(4)} ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Atn(1) = ${result.toFixed(4)} (attendu: ‚âà ${(Math.PI / 4).toFixed(4)}) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Atn non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Atn: ${e.message} ‚úó`, false);
                  }

                  const successRate = Math.round((passed / total) * 100);
                  logResult(resultDiv, `\n=== R√©sultat: ${passed}/${total} tests r√©ussis (${successRate}%) ===`, passed === total);

                  testResults.totalTests += total;
                  testResults.passedTests += passed;
                  testResults.failedTests += (total - passed);
                  testResults.functionResults.set('MathTrig', { passed, total, successRate });

                  updateGlobalStats();
              }

              // Test des fonctions Math arithm√©tiques
              function testMathArithmetic() {
                  const resultDiv = 'mathArithmeticResult';
                  document.getElementById(resultDiv).innerHTML = '';
                  logResult(resultDiv, 'D√©but des tests Math arithm√©tiques...', true);

                  let passed = 0, total = 0;

                  // Test Abs
                  total++;
                  try {
                      if (typeof Abs === 'function') {
                          const result = Abs(-15.7);
                          if (result === 15.7) {
                              logResult(resultDiv, `Abs(-15.7) = ${result} ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Abs(-15.7) = ${result} (attendu: 15.7) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Abs non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Abs: ${e.message} ‚úó`, false);
                  }

                  // Test Sqr
                  total++;
                  try {
                      if (typeof Sqr === 'function') {
                          const result = Sqr(16);
                          if (result === 4) {
                              logResult(resultDiv, `Sqr(16) = ${result} ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Sqr(16) = ${result} (attendu: 4) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Sqr non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Sqr: ${e.message} ‚úó`, false);
                  }

                  // Test Int
                  total++;
                  try {
                      if (typeof Int === 'function') {
                          const result = Int(15.7);
                          if (result === 15) {
                              logResult(resultDiv, `Int(15.7) = ${result} ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Int(15.7) = ${result} (attendu: 15) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Int non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Int: ${e.message} ‚úó`, false);
                  }

                  // Test Fix
                  total++;
                  try {
                      if (typeof Fix === 'function') {
                          const result = Fix(-15.7);
                          if (result === -15) {
                              logResult(resultDiv, `Fix(-15.7) = ${result} ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Fix(-15.7) = ${result} (attendu: -15) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Fix non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Fix: ${e.message} ‚úó`, false);
                  }

                  // Test Log
                  total++;
                  try {
                      if (typeof Log === 'function') {
                          const result = Log(Math.E);
                          if (Math.abs(result - 1) < 0.0001) {
                              logResult(resultDiv, `Log(e) = ${result.toFixed(4)} ‚âà 1.0000 ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Log(e) = ${result.toFixed(4)} (attendu: ‚âà 1.0000) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Log non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Log: ${e.message} ‚úó`, false);
                  }

                  // Test Exp
                  total++;
                  try {
                      if (typeof Exp === 'function') {
                          const result = Exp(1);
                          if (Math.abs(result - Math.E) < 0.0001) {
                              logResult(resultDiv, `Exp(1) = ${result.toFixed(4)} ‚âà ${Math.E.toFixed(4)} ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Exp(1) = ${result.toFixed(4)} (attendu: ‚âà ${Math.E.toFixed(4)}) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Exp non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Exp: ${e.message} ‚úó`, false);
                  }

                  // Test Rnd
                  total++;
                  try {
                      if (typeof Rnd === 'function') {
                          const result = Rnd();
                          if (typeof result === 'number' && result >= 0 && result < 1) {
                              logResult(resultDiv, `Rnd() = ${result.toFixed(4)} (entre 0 et 1) ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Rnd() = ${result} (attendu: nombre entre 0 et 1) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Rnd non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Rnd: ${e.message} ‚úó`, false);
                  }

                  const successRate = Math.round((passed / total) * 100);
                  logResult(resultDiv, `\n=== R√©sultat: ${passed}/${total} tests r√©ussis (${successRate}%) ===`, passed === total);

                  testResults.totalTests += total;
                  testResults.passedTests += passed;
                  testResults.failedTests += (total - passed);
                  testResults.functionResults.set('MathArithmetic', { passed, total, successRate });

                  updateGlobalStats();
              }

              // Test des fonctions de conversion
              function testConversions() {
                  const resultDiv = 'conversionsResult';
                  document.getElementById(resultDiv).innerHTML = '';
                  logResult(resultDiv, 'D√©but des tests de conversion...', true);

                  let passed = 0, total = 0;

                  // Test CInt
                  total++;
                  try {
                      if (typeof CInt === 'function') {
                          const result = CInt('123');
                          if (result === 123 && typeof result === 'number') {
                              logResult(resultDiv, `CInt('123') = ${result} (type: ${typeof result}) ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `CInt('123') = ${result} (type: ${typeof result}) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction CInt non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur CInt: ${e.message} ‚úó`, false);
                  }

                  // Test CStr
                  total++;
                  try {
                      if (typeof CStr === 'function') {
                          const result = CStr(123.45);
                          if (typeof result === 'string' && result === '123.45') {
                              logResult(resultDiv, `CStr(123.45) = '${result}' (type: ${typeof result}) ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `CStr(123.45) = '${result}' (type: ${typeof result}) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction CStr non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur CStr: ${e.message} ‚úó`, false);
                  }

                  // Test CBool
                  total++;
                  try {
                      if (typeof CBool === 'function') {
                          const result = CBool(1);
                          if (typeof result === 'boolean' && result === true) {
                              logResult(resultDiv, `CBool(1) = ${result} (type: ${typeof result}) ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `CBool(1) = ${result} (type: ${typeof result}) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction CBool non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur CBool: ${e.message} ‚úó`, false);
                  }

                  // Test CDbl
                  total++;
                  try {
                      if (typeof CDbl === 'function') {
                          const result = CDbl('123.45');
                          if (typeof result === 'number' && result === 123.45) {
                              logResult(resultDiv, `CDbl('123.45') = ${result} (type: ${typeof result}) ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `CDbl('123.45') = ${result} (type: ${typeof result}) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction CDbl non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur CDbl: ${e.message} ‚úó`, false);
                  }

                  const successRate = Math.round((passed / total) * 100);
                  logResult(resultDiv, `\n=== R√©sultat: ${passed}/${total} tests r√©ussis (${successRate}%) ===`, passed === total);

                  testResults.totalTests += total;
                  testResults.passedTests += passed;
                  testResults.failedTests += (total - passed);
                  testResults.functionResults.set('Conversions', { passed, total, successRate });

                  updateGlobalStats();
              }

              // Test des fonctions de validation
              function testValidation() {
                  const resultDiv = 'validationResult';
                  document.getElementById(resultDiv).innerHTML = '';
                  logResult(resultDiv, 'D√©but des tests de validation...', true);

                  let passed = 0, total = 0;

                  // Test IsNumeric
                  total++;
                  try {
                      if (typeof IsNumeric === 'function') {
                          const result1 = IsNumeric('123');
                          const result2 = IsNumeric('abc');
                          if (result1 === true && result2 === false) {
                              logResult(resultDiv, `IsNumeric('123') = ${result1}, IsNumeric('abc') = ${result2} ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `IsNumeric('123') = ${result1}, IsNumeric('abc') = ${result2} ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction IsNumeric non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur IsNumeric: ${e.message} ‚úó`, false);
                  }

                  // Test VarType
                  total++;
                  try {
                      if (typeof VarType === 'function') {
                          const result1 = VarType(123);
                          const result2 = VarType('hello');
                          const result3 = VarType(true);
                          logResult(resultDiv, `VarType(123) = ${result1}, VarType('hello') = ${result2}, VarType(true) = ${result3} ‚úì`, true);
                          passed++;
                      } else {
                          logResult(resultDiv, 'Fonction VarType non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur VarType: ${e.message} ‚úó`, false);
                  }

                  // Test TypeName
                  total++;
                  try {
                      if (typeof TypeName === 'function') {
                          const result1 = TypeName(123);
                          const result2 = TypeName('hello');
                          const result3 = TypeName(true);
                          logResult(resultDiv, `TypeName(123) = '${result1}', TypeName('hello') = '${result2}', TypeName(true) = '${result3}' ‚úì`, true);
                          passed++;
                      } else {
                          logResult(resultDiv, 'Fonction TypeName non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur TypeName: ${e.message} ‚úó`, false);
                  }

                  const successRate = Math.round((passed / total) * 100);
                  logResult(resultDiv, `\n=== R√©sultat: ${passed}/${total} tests r√©ussis (${successRate}%) ===`, passed === total);

                  testResults.totalTests += total;
                  testResults.passedTests += passed;
                  testResults.failedTests += (total - passed);
                  testResults.functionResults.set('Validation', { passed, total, successRate });

                  updateGlobalStats();
              }

              // Test des fonctions Date/Time
              function testDateTime() {
                  const resultDiv = 'dateTimeResult';
                  document.getElementById(resultDiv).innerHTML = '';
                  logResult(resultDiv, 'D√©but des tests Date/Time...', true);

                  let passed = 0, total = 0;

                  // Test Now
                  total++;
                  try {
                      if (typeof Now === 'function') {
                          const result = Now();
                          if (result instanceof Date) {
                              logResult(resultDiv, `Now() = ${result.toString()} ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Now() = ${result} (attendu: Date object) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Now non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Now: ${e.message} ‚úó`, false);
                  }

                  // Test DateAdd
                  total++;
                  try {
                      if (typeof DateAdd === 'function') {
                          const testDate = new Date(2024, 0, 1); // 1er janvier 2024
                          const result = DateAdd('d', 10, testDate);
                          if (result instanceof Date) {
                              logResult(resultDiv, `DateAdd('d', 10, ${testDate.toDateString()}) = ${result.toDateString()} ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `DateAdd('d', 10, date) = ${result} (attendu: Date object) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction DateAdd non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur DateAdd: ${e.message} ‚úó`, false);
                  }

                  // Test Format
                  total++;
                  try {
                      if (typeof Format === 'function') {
                          const testDate = new Date(2024, 0, 15, 14, 30, 0); // 15 janvier 2024, 14:30:00
                          const result = Format(testDate, 'yyyy-mm-dd');
                          if (typeof result === 'string' && result.includes('2024')) {
                              logResult(resultDiv, `Format(date, 'yyyy-mm-dd') = '${result}' ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Format(date, 'yyyy-mm-dd') = '${result}' ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Format non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Format: ${e.message} ‚úó`, false);
                  }

                  const successRate = Math.round((passed / total) * 100);
                  logResult(resultDiv, `\n=== R√©sultat: ${passed}/${total} tests r√©ussis (${successRate}%) ===`, passed === total);

                  testResults.totalTests += total;
                  testResults.passedTests += passed;
                  testResults.failedTests += (total - passed);
                  testResults.functionResults.set('DateTime', { passed, total, successRate });

                  updateGlobalStats();
              }

              // Test des fonctions temporelles
              function testTimeFunc() {
                  const resultDiv = 'timeFuncResult';
                  document.getElementById(resultDiv).innerHTML = '';
                  logResult(resultDiv, 'D√©but des tests fonctions temporelles...', true);

                  let passed = 0, total = 0;

                  // Test Timer
                  total++;
                  try {
                      if (typeof Timer === 'function') {
                          const result = Timer();
                          if (typeof result === 'number' && result > 0) {
                              logResult(resultDiv, `Timer() = ${result.toFixed(2)} secondes ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Timer() = ${result} (attendu: nombre positif) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Timer non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Timer: ${e.message} ‚úó`, false);
                  }

                  // Test Year
                  total++;
                  try {
                      if (typeof Year === 'function') {
                          const testDate = new Date(2024, 5, 15);
                          const result = Year(testDate);
                          if (result === 2024) {
                              logResult(resultDiv, `Year(${testDate.toDateString()}) = ${result} ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Year(date) = ${result} (attendu: 2024) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Year non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Year: ${e.message} ‚úó`, false);
                  }

                  // Test Month
                  total++;
                  try {
                      if (typeof Month === 'function') {
                          const testDate = new Date(2024, 5, 15); // Juin = mois 6
                          const result = Month(testDate);
                          if (result === 6) {
                              logResult(resultDiv, `Month(${testDate.toDateString()}) = ${result} ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Month(date) = ${result} (attendu: 6) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Month non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Month: ${e.message} ‚úó`, false);
                  }

                  // Test Day
                  total++;
                  try {
                      if (typeof Day === 'function') {
                          const testDate = new Date(2024, 5, 15);
                          const result = Day(testDate);
                          if (result === 15) {
                              logResult(resultDiv, `Day(${testDate.toDateString()}) = ${result} ‚úì`, true);
                              passed++;
                          } else {
                              logResult(resultDiv, `Day(date) = ${result} (attendu: 15) ‚úó`, false);
                          }
                      } else {
                          logResult(resultDiv, 'Fonction Day non disponible ‚úó', false);
                      }
                  } catch (e) {
                      logResult(resultDiv, `Erreur Day: ${e.message} ‚úó`, false);
                  }

                  const successRate = Math.round((passed / total) * 100);
                  logResult(resultDiv, `\n=== R√©sultat: ${passed}/${total} tests r√©ussis (${successRate}%) ===`, passed === total);

                  testResults.totalTests += total;
                  testResults.passedTests += passed;
                  testResults.failedTests += (total - passed);
                  testResults.functionResults.set('TimeFunc', { passed, total, successRate });

                  updateGlobalStats();
              }

              // Test de performance
              function testPerformance() {
                  const resultDiv = 'performanceResult';
                  document.getElementById(resultDiv).innerHTML = '';
                  logResult(resultDiv, 'D√©but du benchmark de performance...', true);

                  const iterations = 10000;
                  const tests = [
                      {
                          name: 'String Concatenation',
                          func: () => {
                              let result = '';
                              for (let i = 0; i < iterations; i++) {
                                  result = 'Hello' + ' ' + 'World' + ' ' + i;
                              }
                              return result;
                          }
                      },
                      {
                          name: 'Math Operations',
                          func: () => {
                              let result = 0;
                              for (let i = 0; i < iterations; i++) {
                                  result = Math.sin(i) * Math.cos(i) + Math.sqrt(i);
                              }
                              return result;
                          }
                      },
                      {
                          name: 'Array Operations',
                          func: () => {
                              const arr = [];
                              for (let i = 0; i < iterations; i++) {
                                  arr.push(i);
                                  if (i > 100) arr.shift();
                              }
                              return arr;
                          }
                      },
                      {
                          name: 'Function Calls VB6',
                          func: () => {
                              let result = '';
                              for (let i = 0; i < Math.min(iterations, 1000); i++) {
                                  if (typeof Left === 'function' && typeof Right === 'function' && typeof Mid === 'function') {
                                      result = Left('Hello World', 5) + Right('Hello World', 5) + Mid('Hello World', 3, 3);
                                  }
                              }
                              return result;
                          }
                      }
                  ];

                  let totalScore = 0;
                  tests.forEach(test => {
                      const startTime = performance.now();
                      try {
                          test.func();
                          const endTime = performance.now();
                          const duration = endTime - startTime;
                          const score = Math.max(0, Math.round(1000 - duration));
                          totalScore += score;

                          logResult(resultDiv, `${test.name}: ${duration.toFixed(2)}ms (Score: ${score}/1000) ‚úì`, true);
                      } catch (e) {
                          logResult(resultDiv, `${test.name}: ERREUR - ${e.message} ‚úó`, false);
                      }
                  });

                  const averageScore = Math.round(totalScore / tests.length);
                  testResults.performanceScores.push(averageScore);

                  logResult(resultDiv, `\n=== Score Performance Global: ${averageScore}/1000 ===`, averageScore > 500);

                  updateGlobalStats();
              }

              // Test de m√©moire
              function testMemory() {
                  const resultDiv = 'memoryResult';
                  document.getElementById(resultDiv).innerHTML = '';
                  logResult(resultDiv, 'D√©but des tests de gestion m√©moire...', true);

                  // Test de fuite m√©moire potentielle
                  if (typeof performance !== 'undefined' && 'memory' in performance) {
                      const memory = (performance as any).memory;
                      logResult(resultDiv, `M√©moire utilis√©e: ${Math.round(memory.usedJSHeapSize / 1024 / 1024)}MB`, true);
                      logResult(resultDiv, `Limite m√©moire: ${Math.round(memory.jsHeapSizeLimit / 1024 / 1024)}MB`, true);
                      logResult(resultDiv, `M√©moire totale: ${Math.round(memory.totalJSHeapSize / 1024 / 1024)}MB`, true);

                      const memoryUsagePercent = (memory.usedJSHeapSize / memory.jsHeapSizeLimit) * 100;
                      logResult(resultDiv, `Utilisation m√©moire: ${memoryUsagePercent.toFixed(2)}%`, memoryUsagePercent < 80);
                  } else {
                      logResult(resultDiv, 'API Performance.memory non disponible dans ce navigateur', false);
                  }

                  // Test de cr√©ation/destruction d'objets
                  try {
                      const objects = [];
                      const startTime = performance.now();

                      for (let i = 0; i < 10000; i++) {
                          objects.push({ id: i, data: 'test' + i });
                      }

                      // Forcer le garbage collection
                      objects.splice(0, objects.length);

                      const endTime = performance.now();
                      logResult(resultDiv, `Cr√©ation/destruction 10k objets: ${(endTime - startTime).toFixed(2)}ms ‚úì`, true);

                  } catch (e) {
                      logResult(resultDiv, `Erreur test objets: ${e.message} ‚úó`, false);
                  }
              }

              // Test d'ex√©cution d'un programme VB6 complet
              function testCompleteVB6Program() {
                  const resultDiv = 'completeResult';
                  document.getElementById(resultDiv).innerHTML = '';
                  logResult(resultDiv, 'Test d\'ex√©cution programme VB6 complet...', true);

                  try {
                      // Programme VB6 simul√©
                      const vb6Code = `
      Private Sub Form_Load()
          Dim message As String
          Dim userName As String
          Dim result As Integer

          message = "Bienvenue dans le programme VB6!"
          userName = "Utilisateur Test"

          ' Test des fonctions string
          message = Left(message, 10) & " " & Right(message, 5)

          ' Test des fonctions math
          result = Int(Sqr(16) + Abs(-5))

          ' Test des conversions
          message = message & " R√©sultat: " & CStr(result)

          ' Test des conditions
          If result > 0 Then
              message = message & " (Positif)"
          Else
              message = message & " (N√©gatif)"
          End If

          ' Affichage du r√©sultat
          Return message
      End Sub
                      `;

                      // Simulation d'ex√©cution
                      let executionResult = '';
                      let passed = 0, total = 0;

                      // Test Form_Load
                      total++;
                      try {
                          let message = "Bienvenue dans le programme VB6!";
                          const userName = "Utilisateur Test";

                          // Test Left et Right
                          if (typeof Left === 'function' && typeof Right === 'function') {
                              message = Left(message, 10) + " " + Right(message, 5);
                              logResult(resultDiv, `String manipulation: "${message}" ‚úì`, true);
                          }

                          // Test math functions
                          let result = 0;
                          if (typeof Int === 'function' && typeof Sqr === 'function' && typeof Abs === 'function') {
                              result = Int(Sqr(16) + Abs(-5));
                              logResult(resultDiv, `Math calculation: Sqr(16) + Abs(-5) = ${result} ‚úì`, true);
                          }

                          // Test conversion
                          if (typeof CStr === 'function') {
                              message = message + " R√©sultat: " + CStr(result);
                              logResult(resultDiv, `Conversion test: CStr(${result}) ‚úì`, true);
                          }

                          // Test condition
                          if (result > 0) {
                              message = message + " (Positif)";
                              logResult(resultDiv, `Condition test: ${result} > 0 = true ‚úì`, true);
                          } else {
                              message = message + " (N√©gatif)";
                              logResult(resultDiv, `Condition test: ${result} > 0 = false ‚úì`, true);
                          }

                          executionResult = message;
                          passed++;

                      } catch (e) {
                          logResult(resultDiv, `Erreur Form_Load: ${e.message} ‚úó`, false);
                      }

                      // Test des √©v√©nements
                      total++;
                      try {
                          // Simulation d'un √©v√©nement Click
                          let clickHandled = false;
                          const cmdClick = function() {
                              clickHandled = true;
                              return "Click event handled";
                          };

                          const clickResult = cmdClick();
                          if (clickHandled && clickResult) {
                              logResult(resultDiv, `Event handling: ${clickResult} ‚úì`, true);
                              passed++;
                          }
                      } catch (e) {
                          logResult(resultDiv, `Erreur event handling: ${e.message} ‚úó`, false);
                      }

                      // Test des boucles
                      total++;
                      try {
                          let loopResult = '';
                          for (let i = 1; i <= 5; i++) {
                              loopResult += `Iteration ${i} `;
                          }

                          if (loopResult.includes('Iteration 5')) {
                              logResult(resultDiv, `Loop test: "${loopResult.trim()}" ‚úì`, true);
                              passed++;
                          }
                      } catch (e) {
                          logResult(resultDiv, `Erreur loop test: ${e.message} ‚úó`, false);
                      }

                      const successRate = Math.round((passed / total) * 100);
                      logResult(resultDiv, `\n=== Programme VB6 ex√©cut√© avec succ√®s ===`, true);
                      logResult(resultDiv, `R√©sultat final: "${executionResult}"`, true);
                      logResult(resultDiv, `Tests r√©ussis: ${passed}/${total} (${successRate}%)`, passed === total);

                      testResults.totalTests += total;
                      testResults.passedTests += passed;
                      testResults.failedTests += (total - passed);
                      testResults.functionResults.set('CompleteProgram', { passed, total, successRate });

                      updateGlobalStats();

                  } catch (e) {
                      logResult(resultDiv, `Erreur g√©n√©rale: ${e.message} ‚úó`, false);
                  }
              }

              // G√©n√©ration du rapport final
              function generateFinalReport() {
                  const reportDiv = document.getElementById('finalReport');
                  const totalTime = (Date.now() - testResults.startTime) / 1000;

                  let report = `
                      <h3>üìä RAPPORT FINAL D'√âVALUATION DU RUNTIME VB6</h3>
                      <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 15px 0;">
                          <h4>Statistiques Globales:</h4>
                          <ul>
                              <li><strong>Tests Totaux:</strong> ${testResults.totalTests}</li>
                              <li><strong>Tests R√©ussis:</strong> ${testResults.passedTests}</li>
                              <li><strong>Tests √âchou√©s:</strong> ${testResults.failedTests}</li>
                              <li><strong>Taux de Succ√®s:</strong> ${testResults.totalTests > 0 ? Math.round((testResults.passedTests / testResults.totalTests) * 100) : 0}%</li>
                              <li><strong>Temps d'Ex√©cution:</strong> ${totalTime.toFixed(2)} secondes</li>
                          </ul>
                      </div>

                      <h4>D√©tails par Cat√©gorie:</h4>
                  `;

                  testResults.functionResults.forEach((result, category) => {
                      const color = result.successRate >= 80 ? '#27ae60' : result.successRate >= 50 ? '#f39c12' : '#e74c3c';
                      report += `
                          <div style="margin: 10px 0; padding: 10px; border-left: 4px solid ${color}; background: #f9f9f9;">
                              <strong>${category}:</strong> ${result.passed}/${result.total} tests (${result.successRate}%)
                          </div>
                      `;
                  });

                  // Score de performance moyen
                  if (testResults.performanceScores.length > 0) {
                      const avgPerformance = testResults.performanceScores.reduce((a, b) => a + b, 0) / testResults.performanceScores.length;
                      report += `
                          <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin: 15px 0;">
                              <h4>Performance:</h4>
                              <p><strong>Score Moyen:</strong> ${avgPerformance.toFixed(0)}/1000</p>
                              <div style="background: #ddd; border-radius: 10px; padding: 3px;">
                                  <div style="background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%); height: 20px; width: ${avgPerformance/10}%; border-radius: 10px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">
                                      ${avgPerformance.toFixed(0)}/1000
                                  </div>
                              </div>
                          </div>
                      `;
                  }

                  // √âvaluation finale
                  const overallScore = testResults.totalTests > 0 ? (testResults.passedTests / testResults.totalTests) * 100 : 0;
                  let evaluation = '';
                  let color = '';

                  if (overallScore >= 90) {
                      evaluation = 'EXCELLENT - Runtime VB6 pleinement fonctionnel';
                      color = '#27ae60';
                  } else if (overallScore >= 70) {
                      evaluation = 'BON - Runtime VB6 majoritairement fonctionnel';
                      color = '#2ecc71';
                  } else if (overallScore >= 50) {
                      evaluation = 'MOYEN - Runtime VB6 partiellement fonctionnel';
                      color = '#f39c12';
                  } else {
                      evaluation = 'INSUFFISANT - Runtime VB6 n√©cessite des am√©liorations';
                      color = '#e74c3c';
                  }

                  report += `
                      <div style="background: ${color}; color: white; padding: 20px; border-radius: 8px; margin: 20px 0; text-align: center;">
                          <h3>üéØ √âVALUATION FINALE</h3>
                          <h4>${evaluation}</h4>
                          <p>Score Global: ${overallScore.toFixed(1)}%</p>
                      </div>

                      <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
                          <h4>Recommandations:</h4>
                          <ul>
                              <li>${overallScore >= 90 ? '‚úÖ' : '‚ö†Ô∏è'} Fonctions VB6 de base ${overallScore >= 90 ? 'compl√®tes' : '√† compl√©ter'}</li>
                              <li>${testResults.performanceScores.length > 0 && testResults.performanceScores[0] > 500 ? '‚úÖ' : '‚ö†Ô∏è'} Performance ${testResults.performanceScores.length > 0 && testResults.performanceScores[0] > 500 ? 'satisfaisante' : '√† optimiser'}</li>
                              <li>${testResults.functionResults.has('CompleteProgram') ? '‚úÖ' : '‚ö†Ô∏è'} Ex√©cution de programmes ${testResults.functionResults.has('CompleteProgram') ? 'test√©e' : '√† tester'}</li>
                              <li>üìà Continuer les tests avec des programmes VB6 plus complexes</li>
                              <li>üîß Impl√©menter les fonctions manquantes identifi√©es</li>
                              <li>‚ö° Optimiser les performances si n√©cessaire</li>
                          </ul>
                      </div>
                  `;

                  reportDiv.innerHTML = report;
              }

              // Mise √† jour des statistiques globales
              function updateGlobalStats() {
                  const totalFunctionsAvailable = [
                      'Left', 'Right', 'Mid', 'Len', 'InStr', 'Replace', 'Trim', 'StrComp', 'StrReverse', 'Split', 'Join', 'Filter',
                      'Sin', 'Cos', 'Tan', 'Atn', 'Abs', 'Sqr', 'Int', 'Fix', 'Log', 'Exp', 'Rnd',
                      'CInt', 'CStr', 'CBool', 'CDbl', 'IsNumeric', 'VarType', 'TypeName',
                      'Now', 'DateAdd', 'Format', 'Timer', 'Year', 'Month', 'Day'
                  ];

                  let availableCount = 0;
                  totalFunctionsAvailable.forEach(func => {
                      if (typeof (window as any)[func] === 'function') {
                          availableCount++;
                      }
                  });

                  document.getElementById('totalFunctions').textContent = availableCount.toString();
                  document.getElementById('testedFunctions').textContent = Array.from(testResults.functionResults.keys()).length.toString();

                  const successRate = testResults.totalTests > 0 ? Math.round((testResults.passedTests / testResults.totalTests) * 100) : 0;
                  document.getElementById('successRate').textContent = successRate + '%';

                  const performanceScore = testResults.performanceScores.length > 0 ? Math.round(testResults.performanceScores.reduce((a, b) => a + b, 0) / testResults.performanceScores.length) : 0;
                  document.getElementById('performanceScore').textContent = performanceScore.toString();

                  // Mise √† jour de la barre de progression
                  const progressPercent = Math.min(100, (Array.from(testResults.functionResults.keys()).length / 8) * 100);
                  const progressBar = document.getElementById('globalProgress');
                  progressBar.style.width = progressPercent + '%';
                  progressBar.textContent = Math.round(progressPercent) + '%';
              }

              // Initialisation au chargement de la page
              window.addEventListener('load', () => {
                  logResult = logResult; // Ensure function is available
                  updateGlobalStats();

                  // V√©rifier si le runtime VB6 est charg√©
                  setTimeout(() => {
                      const criticalFunctions = ['Left', 'Right', 'Mid', 'Len', 'Sin', 'Cos', 'Abs', 'CInt', 'Now'];
                      let loadedFunctions = 0;

                      criticalFunctions.forEach(func => {
                          if (typeof (window as any)[func] === 'function') {
                              loadedFunctions++;
                          }
                      });

                      const loadPercentage = Math.round((loadedFunctions / criticalFunctions.length) * 100);

                      if (loadPercentage > 50) {
                          console.log(`üü¢ Runtime VB6 partiellement charg√©: ${loadedFunctions}/${criticalFunctions.length} fonctions (${loadPercentage}%)`);
                      } else {
                          console.log(`üî¥ Runtime VB6 non charg√©: ${loadedFunctions}/${criticalFunctions.length} fonctions (${loadPercentage}%)`);
                      }
                  }, 1000);
              });
    </script>
  </body>
</html>
